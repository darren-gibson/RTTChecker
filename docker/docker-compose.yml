version: '3.8'

services:
  train-status:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    image: train-status:latest
    container_name: train-status
    network_mode: host
    restart: unless-stopped

    # Required capabilities for mDNS/Avahi in container
    cap_add:
      - NET_ADMIN
      - NET_RAW

    # Environment variables - configure via .env file (copy from .env.example)
    env_file:
      - ../.env

    # Persist Matter commissioning data
    volumes:
      - ./matter-storage:/app/.matter-storage:Z

    # Note: No logging driver specified - Podman's default (k8s-file) and Docker's
    # default both preserve the app's LOG_FORMAT. Avoid json-file driver as it
    # wraps output in JSON regardless of LOG_FORMAT setting.
